# Hapitas Trivago Bot — クイックランチャー

短く言うと: Hapitas の指定商品ページへログイン→リダイレクトボタンを人間らしく押して外部サイトへ遷移、遷移先をスクロールして戻る処理を自動化します。人間らしい待機・マウス挙動を模した設計です。

---

## ⚡ 特徴
- cookie.json を読み込んでログイン状態を再現
- サインインフォームにメール / パスワードを入力してログイン（reCAPTCHA は自動回避しません）
- 指定商品ページへ移動し「ショップへ移動」ボタンを人間っぽくクリック
- 新しいタブで開いたページを数秒待機＆ランダムにスクロールして閉じる
- クリック処理をランダム回数ループ（ヒューマン差を再現）

---

## 🔧 必要条件
- Python 3.9+
- Chrome（ローカルインストール）
- 依存パッケージ（インストール方法は下記）

requirements.txt を使う:
```
pip install -r requirements.txt
```

デフォルトで含まれている主なパッケージ:
- selenium
- webdriver-manager

（オプションで検出回避用のライブラリを追加検討可）

---

## ⚙ 使い方（ざっくり）
1. このリポジトリをローカルに置く。
2. cookie.json を main.py と同じフォルダに配置する（下記フォーマット参照）。
3. 必要な依存をインストール:
   ```
   pip install -r requirements.txt
   ```
4. 実行:
   ```
   python main.py
   ```

---

## 📁 cookie.json のフォーマット
main.py は以下のどちらの形式を受け付けます:
- Cookieオブジェクトの配列（例: ブラウザ拡張でエクスポートした JSON）
- { "cookies": [ ... ] } の形式（先に cookies を抽出）

例:
```
[
  {
    "name": "sessionid",
    "value": "abcd",
    "domain": ".hapitas.jp",
    "path": "/"
  }
]
```

注意: Selenium の add_cookie は現在のドメインと一致する cookie を要求します。main.py は最初に HOMEPAGE を開いてから cookie を追加します。

---

## ⚠️ 注意事項
- reCAPTCHA（Invisible reCAPTCHA）を自動で回避する実装は含みません。サイト側がチャレンジを表示した場合は手動対応が必要です。
-reCAPTCHAの手動対応時間は60秒間です。うまくいかない場合は一度閉じてやり直してください。
- 自動操作はサービス利用規約に抵触する可能性があります。利用は自己責任で行ってください。
- 本プログラムは「人間っぽさ」を模するための遅延・挙動を入れていますが、検出を完全に回避する保証はありません。

---

## カスタマイズポイント
- USER AGENT の追加（pick_user_agent）
- ループ回数や待機時間（main 内の定数）
- スクロール量 / スピード（window.scrollBy 実行箇所）

---
